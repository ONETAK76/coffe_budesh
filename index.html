<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Coffee Wallet</title>
    <script src="https://telegram.org"></script>
    <script src="https://cdn.jsdelivr.net"></script>
    <style>
        body { background: #000; color: #fff; font-family: -apple-system, sans-serif; display: flex; justify-content: center; padding-top: 40px; margin: 0; overflow: hidden; }
        .wallet-card { width: 320px; height: 480px; background: linear-gradient(145deg, #2c1e14, #1a0f0a); border-radius: 20px; padding: 25px; border: 1px solid #4a3427; box-shadow: 0 20px 40px rgba(0,0,0,0.8); display: flex; flex-direction: column; justify-content: space-between; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-weight: 800; font-size: 18px; color: #e4d5c9; }
        .chip { width: 40px; height: 30px; background: #8d6e63; border-radius: 5px; opacity: 0.5; }
        .balance-label { font-size: 12px; color: #a1887f; text-transform: uppercase; margin-top: 60px; }
        .balance-value { font-size: 42px; font-weight: 700; color: #fff; }
        .barcode-box { background: #fff; border-radius: 12px; padding: 15px; display: flex; justify-content: center; align-items: center; margin-bottom: 10px; }
        .admin-btn { background: #e4d5c9; color: #1a0f0a; border: none; padding: 15px; border-radius: 12px; font-weight: bold; width: 100%; display: none; }
    </style>
</head>
<body>
    <div class="wallet-card">
        <div class="header">
            <div class="logo">COFFEE BUDES</div>
            <div class="chip"></div>
        </div>
        <div>
            <div class="balance-label">–ë–æ–Ω—É—Å–Ω—ã–π –±–∞–ª–∞–Ω—Å</div>
            <div class="balance-value" id="bal">0.00</div>
        </div>
        <div class="barcode-box">
            <svg id="barcode"></svg>
        </div>
        <button id="adminBtn" class="admin-btn">üì∏ –û–¢–ö–†–´–¢–¨ –°–ö–ê–ù–ï–†</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        const params = new URLSearchParams(window.location.search);
        const userId = params.get('id');
        const balance = params.get('bal') || '0.00';
        const isAdmin = params.get('admin') === '1';

        document.getElementById('bal').innerText = balance;
        if (isAdmin) document.getElementById('adminBtn').style.display = 'block';

        JsBarcode("#barcode", userId, { format: "CODE128", width: 2, height: 60, displayValue: true, fontSize: 14 });

        document.getElementById('adminBtn').onclick = () => {
            tg.showScanQrPopup({ text: "–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –∫–æ–¥ –≥–æ—Å—Ç—è" }, (text) => {
                tg.sendData(text); // –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ID –≥–æ—Å—Ç—è –±–æ—Ç—É
                tg.closeScanQrPopup();
            });
        };
    </script>
</body>
</html>
